<!DOCTYPE html>
<html lang="en"><head>
<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/tabby.min.js"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.450">

  <meta name="author" content="Aya mitani">
  <title>Module 1: Introduction, visualization, and general linear models</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #cbccc6; background-color: #1f2430; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #cbccc6; } /* Normal */
    code span.al { color: #ff3333; background-color: #332430; font-weight: bold; } /* Alert */
    code span.an { color: #ffe6b3; } /* Annotation */
    code span.at { color: #73d0ff; } /* Attribute */
    code span.bn { color: #ffcc66; } /* BaseN */
    code span.bu { color: #95e6cb; } /* BuiltIn */
    code span.cf { color: #ffa759; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #95e6cb; } /* Char */
    code span.cn { color: #d4bfff; } /* Constant */
    code span.co { color: #5c6773; font-style: italic; } /* Comment */
    code span.cv { color: #d4bfff; } /* CommentVar */
    code span.do { color: #5c6773; } /* Documentation */
    code span.dt { color: #ffa759; } /* DataType */
    code span.dv { color: #ffcc66; } /* DecVal */
    code span.er { color: #ff3333; text-decoration: underline; } /* Error */
    code span.ex { color: #73d0ff; font-weight: bold; } /* Extension */
    code span.fl { color: #ffcc66; } /* Float */
    code span.fu { color: #ffd580; } /* Function */
    code span.im { color: #bae67e; } /* Import */
    code span.in { color: #ffcc66; } /* Information */
    code span.kw { color: #ffa759; font-weight: bold; } /* Keyword */
    code span.op { color: #f29e74; } /* Operator */
    code span.ot { color: #5ccfe6; } /* Other */
    code span.pp { color: #f28779; } /* Preprocessor */
    code span.re { color: #73d0ff; background-color: #2a4254; } /* RegionMarker */
    code span.sc { color: #95e6cb; } /* SpecialChar */
    code span.ss { color: #95e6cb; } /* SpecialString */
    code span.st { color: #bae67e; } /* String */
    code span.va { color: #5ccfe6; } /* Variable */
    code span.vs { color: #bae67e; } /* VerbatimString */
    code span.wa { color: #f28779; } /* Warning */
  </style>
  <link rel="stylesheet" href="index_files/libs/revealjs/dist/theme/quarto.css">
  <link href="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="index_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Module 1: Introduction, visualization, and general linear models</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Aya mitani 
</div>
</div>
</div>

</section>
<section id="background-and-housekeeping" class="slide level2">
<h2>Background and housekeeping</h2>
<ul>
<li>Most of workshop materials is from CHL5222 Analysis of Correlated Data taught by me for last four years</li>
<li>Workshop materials are available from [https://github.com/ayamitani/sorataba-workshop2024]{https://github.com/ayamitani/sorataba-workshop2024}</li>
<li>You can view the online slides or follow along with <code>.qmd</code> files</li>
<li>If there are errors (mostly likely there will be!), I will update materials</li>
</ul>
</section>
<section id="contents-of-workshop" class="slide level2">
<h2>Contents of workshop</h2>
<ul>
<li>Workshop focuses on <strong>application</strong> rather than <strong>theory</strong></li>
<li>Example data sets are unrealistically clean
<ul>
<li>Real world data are super messy</li>
<li>Majority of project time is spent on data cleaning</li>
</ul></li>
</ul>
</section>
<section id="todays-schedule" class="slide level2 smaller">
<h2>Today’s schedule</h2>
<ul>
<li>08:15-9:00 Registration &amp; Breakfast</li>
<li>9:00-09:15 Opening Remarks</li>
<li>09:15-10:30 <strong>Module 1</strong></li>
<li>10:30-10:45 Morning Break</li>
<li>10:45-12:00 <strong>Module 2</strong></li>
<li>12:00-13:30 Lunch, Poster Presentation Assessment &amp; Career Panel</li>
<li>13:30-15:00 <strong>Module 3</strong></li>
<li>15:00-15:15 Afternoon Break</li>
<li>15:15-16:45 <strong>Module 4</strong></li>
<li>16:45-17:00 Closing Remarks</li>
</ul>
</section>
<section>
<section id="introduction" class="title-slide slide level1 center">
<h1>Introduction</h1>

</section>
<section id="correlated-data" class="slide level2">
<h2>Correlated data</h2>
<ul>
<li>Many statistical tests and models assume that responses are <strong>univariate</strong> and <strong>independent</strong></li>
<li>In this class, we consider settings where responses are <strong>multivariate</strong> and/or exhibit <strong>dependence</strong></li>
</ul>
</section>
<section id="sources-of-correlation" class="slide level2">
<h2>Sources of correlation</h2>
<p>Correlation between data can arise from many sources:</p>
<h4 id="clustered-data">Clustered data</h4>
<ul>
<li>Units of observation belong to a cluster, either by design or nature
<ul>
<li>Group-randomized trial</li>
<li>Individual members of a family</li>
<li>Patients within a hospital</li>
<li>Teeth within an individual</li>
</ul></li>
<li>Responses within a cluster are usually <strong>positively</strong> correlated</li>
</ul>
</section>
<section id="sources-of-correlation-1" class="slide level2">
<h2>Sources of correlation</h2>
<h4 id="longitudinal-data">Longitudinal data</h4>
<ul>
<li>Each individual’s responses are measured over time</li>
<li>Special case of clustered data
<ul>
<li>Responses are clustered within individuals and have temporal order</li>
<li>Goal is to characterize change in response over time and factors that influence change</li>
<li>Balanced study design: All individuals are measured at the same occasions</li>
<li>Unbalanced study design: Otherwise</li>
</ul></li>
</ul>
</section>
<section id="sources-of-correlation-in-longitudinal-data" class="slide level2">
<h2>Sources of correlation in longitudinal data</h2>
<h4 id="between-individual-heterogeneity">Between-individual heterogeneity</h4>
<ul>
<li>Natural variation in individuals’ propensity to respond
<ul>
<li>Some individuals consistently respond higher than the average, while others consistently respond below the average</li>
</ul></li>
<li>Variability among individuals in their response trajectories over time
<ul>
<li>Some individuals “gains” will be above the average, while others will be below the average</li>
</ul></li>
</ul>
</section>
<section id="sources-of-correlation-in-longitudinal-data-1" class="slide level2 smaller">
<h2>Sources of correlation in longitudinal data</h2>
<h4 id="within-individual-biological-variation">Within-individual biological variation</h4>
<ul>
<li>Responses from the same individual vary over time
<ul>
<li>Measurements on the same individual are more similar the closer in time they are taken, and are less similar the further apart in time</li>
</ul></li>
</ul>
<h4 id="measurement-error">Measurement error</h4>
<ul>
<li>Variability due to the imprecision of the measurement procedure
<ul>
<li>Not unique to longitudinal (clustered) data</li>
<li>Measurement error is
<ul>
<li>low for height and weight</li>
<li>higher for LDL cholesterol, fasting glucose level</li>
<li>high for self-reported measures like well-being and quality-of-life</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="notation" class="slide level2">
<h2>Notation</h2>
<div class="column" style="width:49%;">
<h4 id="independent-data">Independent data</h4>
<ul>
<li>Subject: <span class="math inline">\(i=1,...,N\)</span></li>
<li>Response variable: <span class="math inline">\(Y_{i}\)</span></li>
<li>Explanatory variable: <span class="math inline">\(x_{i}\)</span></li>
</ul>
</div>
<div class="column" style="width:49%;">
<h4 id="correlated-dependent-data">Correlated (dependent) data</h4>
<ul>
<li>Sample:
<ul>
<li>Subject: <span class="math inline">\(i=1,...,N\)</span></li>
<li>Observation: <span class="math inline">\(j=1,...,n_{i}\)</span></li>
<li>Total sample size: <span class="math inline">\(\sum_{i=1}^{N}n_{i}=m\)</span></li>
</ul></li>
<li>Response variable: <span class="math inline">\(Y_{ij}\)</span></li>
<li>Explanatory variable: <span class="math inline">\(x_{ij}\)</span></li>
</ul>
</div>
</section>
<section id="example-1-study-of-dental-growth" class="slide level2 smaller">
<h2>Example 1: Study of dental growth</h2>
<p>A study of dental growth measurements of the distance (mm) from the center of the pituitary gland to the pteryomaxillary fissure were obtained on 11 girls and 16 boys at ages 8, 10, 12, and 14. The objectives were to learn whether there is a difference between boys and girls with respect to the measurements and their rate of change over time. This classic example is used by many authors discussing longitudinal data methods.</p>
<p>The data set is available as <code>dentalstudy.txt</code>.</p>
<table>
<colgroup>
<col style="width: 17%">
<col style="width: 10%">
<col style="width: 71%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: left;">Value</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">id</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Subject ID</td>
</tr>
<tr class="even">
<td style="text-align: left;">gender</td>
<td style="text-align: left;">Character</td>
<td style="text-align: left;">“F” for female, “M” for male</td>
</tr>
<tr class="odd">
<td style="text-align: left;">distance_age8</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Measurement at age 8</td>
</tr>
<tr class="even">
<td style="text-align: left;">distance_age10</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Measurement at age 10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">distance_age12</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Measurement at age 12</td>
</tr>
<tr class="even">
<td style="text-align: left;">distance_age14</td>
<td style="text-align: left;">Numeric</td>
<td style="text-align: left;">Measurement at age 14</td>
</tr>
</tbody>
</table>
</section>
<section id="example-1-study-of-dental-growth-1" class="slide level2 smaller">
<h2>Example 1: Study of dental growth</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>dental <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="fu">here</span>(<span class="st">"datasets"</span>, <span class="st">"dentalstudy.txt"</span>), <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">head</span>(dental)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  id gender distance_age8 distance_age10 distance_age12 distance_age14
1  1      F          21.0           20.0           21.5           23.0
2  2      F          21.0           21.5           24.0           25.5
3  3      F          20.5           24.0           24.5           26.0
4  4      F          23.5           24.5           25.0           26.5
5  5      F          21.5           23.0           22.5           23.5
6  6      F          20.0           21.0           21.0           22.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">tail</span>(dental)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   id gender distance_age8 distance_age10 distance_age12 distance_age14
22 22      M          23.0           23.0           23.5           25.0
23 23      M          21.5           23.5           24.0           28.0
24 24      M          17.0           24.5           26.0           29.5
25 25      M          22.5           25.5           25.5           26.0
26 26      M          23.0           24.5           26.0           30.0
27 27      M          22.0           21.5           23.5           25.0</code></pre>
</div>
</div>
<ul>
<li>Subject: <span class="math inline">\(i=1,...,27\)</span> (<span class="math inline">\(N=29\)</span>)</li>
<li>Observations: <span class="math inline">\(j=1,2,3,4\)</span>, <span class="math inline">\(n_{i}=4\)</span> for all <span class="math inline">\(i\)</span></li>
<li>Total sample size: <span class="math inline">\(\sum_{i=1}^{29}n_{i} = 29 \times 4 = 116\)</span></li>
<li>This data set is in a <strong>wide</strong> format</li>
</ul>
</section>
<section id="data-format" class="slide level2 smaller">
<h2>Data format</h2>
<h4 id="wide-one-row-per-each-patient-i">Wide (One row per each patient <span class="math inline">\(i\)</span>)</h4>
<ul>
<li>Many prefer this format for data collection</li>
<li>Easier to eyeball trend</li>
<li>Only useful for <strong>balanced data</strong> with one type of response and time-independent covariates</li>
</ul>
<h4 id="long-one-row-per-each-observation-j">Long (One row per each observation <span class="math inline">\(j\)</span>)</h4>
<ul>
<li>Most software require this format for analysis</li>
<li>Good for multiple response variables</li>
<li>Good for time-dependent covariates</li>
<li>Good for unbalanced data</li>
<li>Difficult to observe patterns</li>
</ul>
</section>
<section id="wide-to-long-data-format" class="slide level2 smaller">
<h2>Wide to Long Data format</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb5-2"><a href="#cb5-2"></a>dentallong <span class="ot">&lt;-</span> dental <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"distance"</span>),</span>
<span id="cb5-4"><a href="#cb5-4"></a>               <span class="at">names_to =</span> <span class="st">"age"</span>,</span>
<span id="cb5-5"><a href="#cb5-5"></a>               <span class="co"># this removes "distance_age" from the values</span></span>
<span id="cb5-6"><a href="#cb5-6"></a>               <span class="at">names_prefix =</span> <span class="st">"distance_age"</span>, </span>
<span id="cb5-7"><a href="#cb5-7"></a>               <span class="at">values_to =</span> <span class="st">"distance"</span>,</span>
<span id="cb5-8"><a href="#cb5-8"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9"></a>  <span class="co"># convert age to numeric</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>  <span class="fu">mutate</span>(<span class="at">age =</span> <span class="fu">as.numeric</span>(age)) <span class="sc">%&gt;%</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>  <span class="co"># create new variable indicating measurement occasion</span></span>
<span id="cb5-12"><a href="#cb5-12"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb5-13"><a href="#cb5-13"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb5-14"><a href="#cb5-14"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb5-15"><a href="#cb5-15"></a>dentallong</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 108 × 5
      id gender   age distance  time
   &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;int&gt;
 1     1 F          8     21       1
 2     1 F         10     20       2
 3     1 F         12     21.5     3
 4     1 F         14     23       4
 5     2 F          8     21       1
 6     2 F         10     21.5     2
 7     2 F         12     24       3
 8     2 F         14     25.5     4
 9     3 F          8     20.5     1
10     3 F         10     24       2
# ℹ 98 more rows</code></pre>
</div>
</div>
</section>
<section id="descriptive-analysis" class="slide level2 smaller">
<h2>Descriptive analysis</h2>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>dentallong <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="fu">group_by</span>(gender, age) <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n_distinct</span>(id),</span>
<span id="cb7-4"><a href="#cb7-4"></a>            <span class="at">meandist =</span> <span class="fu">mean</span>(distance), </span>
<span id="cb7-5"><a href="#cb7-5"></a>            <span class="at">sddist =</span> <span class="fu">sd</span>(distance)) <span class="sc">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">2</span>,</span>
<span id="cb7-7"><a href="#cb7-7"></a>        <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Gender"</span>, <span class="st">"Age"</span>, </span>
<span id="cb7-8"><a href="#cb7-8"></a>                      <span class="st">"N"</span>, <span class="st">"Mean"</span>, <span class="st">"SD"</span>),</span>
<span id="cb7-9"><a href="#cb7-9"></a>        <span class="at">caption =</span> <span class="st">"Descriptive statistics of </span></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="st">        distance (mm) from center of pituitary </span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="st">        gland to pteryomaxillary fissure by </span></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="st">        gender and age"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output-display">
<table>
<caption>Descriptive statistics of distance (mm) from center of pituitary gland to pteryomaxillary fissure by gender and age</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Gender</th>
<th style="text-align: right;">Age</th>
<th style="text-align: right;">N</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">SD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">F</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">21.18</td>
<td style="text-align: right;">2.12</td>
</tr>
<tr class="even">
<td style="text-align: left;">F</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">22.23</td>
<td style="text-align: right;">1.90</td>
</tr>
<tr class="odd">
<td style="text-align: left;">F</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">23.09</td>
<td style="text-align: right;">2.36</td>
</tr>
<tr class="even">
<td style="text-align: left;">F</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">24.09</td>
<td style="text-align: right;">2.44</td>
</tr>
<tr class="odd">
<td style="text-align: left;">M</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">22.88</td>
<td style="text-align: right;">2.45</td>
</tr>
<tr class="even">
<td style="text-align: left;">M</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">23.81</td>
<td style="text-align: right;">2.14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">M</td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">25.72</td>
<td style="text-align: right;">2.65</td>
</tr>
<tr class="even">
<td style="text-align: left;">M</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">27.47</td>
<td style="text-align: right;">2.09</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</section>
<section id="data-visualization" class="slide level2 smaller">
<h2>Data visualization</h2>
<h4 id="violin-plots-with-boxplots">Violin plots with boxplots</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>dentallong <span class="sc">%&gt;%</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">as.factor</span>(age), <span class="at">y =</span> distance, <span class="at">color =</span> gender)) <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3"></a>    <span class="fu">geom_violin</span>() <span class="sc">+</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>    <span class="fu">geom_boxplot</span>(<span class="at">width =</span> <span class="fl">0.1</span>) <span class="sc">+</span> </span>
<span id="cb8-5"><a href="#cb8-5"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Distance"</span>, <span class="at">x =</span> <span class="st">"Age"</span>, <span class="at">color =</span> <span class="st">"Gender"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-5-1.png" width="960" class="r-stretch"></section>
<section id="data-visualization-1" class="slide level2 smaller">
<h2>Data visualization</h2>
<h4 id="spaghetti-plot">Spaghetti plot</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>dentallong <span class="sc">%&gt;%</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> distance, <span class="at">color =</span> gender)) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span>    <span class="co"># draw points</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> id)) <span class="sc">+</span>  <span class="co"># draw a line across each patient</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Distance"</span>, <span class="at">x =</span> <span class="st">"Age"</span>, <span class="at">color =</span> <span class="st">"Gender"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-6-1.png" width="960" class="r-stretch"></section>
<section id="data-visualization-2" class="slide level2 smaller">
<h2>Data visualization</h2>
<h4 id="scatterplot-with-mean-trajectory">Scatterplot with mean trajectory</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>dentallong <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> age, <span class="at">y =</span> distance, <span class="at">color =</span> gender)) <span class="sc">+</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span>    </span>
<span id="cb10-4"><a href="#cb10-4"></a>  <span class="co"># add mean trajectory for each treatment group</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>  <span class="fu">stat_summary</span>(<span class="fu">aes</span>(<span class="at">group =</span> gender), <span class="at">fun =</span> mean, <span class="at">geom=</span><span class="st">"line"</span>) <span class="sc">+</span> </span>
<span id="cb10-6"><a href="#cb10-6"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">"Distance"</span>, <span class="at">x =</span> <span class="st">"Age"</span>, <span class="at">color =</span> <span class="st">"Gender"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="index_files/figure-revealjs/unnamed-chunk-7-1.png" width="960" class="r-stretch"></section></section>
<section>
<section id="analysis-of-correlated-data" class="title-slide slide level1 center">
<h1>Analysis of correlated data</h1>

</section>
<section id="matrix-representation-of-correlated-data" class="slide level2 smaller">
<h2>Matrix representation of correlated data</h2>
<h4 id="repeated-outcomes">Repeated outcomes</h4>
<p>Let <span class="math inline">\(Y_{ij}\)</span> denote the response variable for the <span class="math inline">\(i\)</span>th cluster (individual) (<span class="math inline">\(i=1,...,N\)</span>) at the <span class="math inline">\(j\)</span>th unit (time) (<span class="math inline">\(j=1,...,n_{i}\)</span>). Using vector notation, we can group the <span class="math inline">\(n_{i}\)</span> repeated measurements of cluster <span class="math inline">\(i\)</span> into a <span class="math inline">\(n_{i}\times 1\)</span> response vector: <span class="math display">\[
Y_{i}=
\left(\begin{array}{c}
Y_{i1}\\
Y_{i2}\\
\vdots \\
Y_{in_{i}}
\end{array}\right),
\quad i = 1,...,N.
\]</span></p>
</section>
<section id="matrix-representation-of-longitudinal-data" class="slide level2 smaller">
<h2>Matrix representation of longitudinal data</h2>
<h4 id="covariates">Covariates</h4>
<div style="font-size: 85%;">
<p>Associated with <span class="math inline">\(Y_{ij}\)</span>, we have a <span class="math inline">\(p \times 1\)</span> vector of covariates</p>
<p><span class="math display">\[
X_{ij} =
\left(\begin{array}{c}
X_{ij1}\\
X_{ij2}\\
\vdots \\
X_{ijp}
\end{array}\right), \quad i = 1,...,N; j=1,...,n_{i}.
\]</span> We can group the vectors of covariates into a <span class="math inline">\(n_{i}\times p\)</span> matrix:</p>
<p><span class="math display">\[
X_{i}=
\left(\begin{array}{c}
X_{i1}^{T}\\
X_{i2}^{T}\\
\vdots \\
X_{ip}^{T}
\end{array}\right)=
\left(\begin{array}{cccc}
X_{i11} &amp; X_{i12} &amp; ... &amp; X_{i1p}\\
X_{i21} &amp; X_{i22} &amp; ... &amp; X_{i2p}\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
X_{in_{i}1} &amp; X_{in_{i}2} &amp; ... &amp; X_{in_{i}p}\\
\end{array}\right), \quad i = 1,...,N.
\]</span> <span class="math inline">\(X_{i}\)</span> is simply an ordered collection of the values of the <span class="math inline">\(p\)</span> covariates for the <span class="math inline">\(i\)</span>th cluster at all <span class="math inline">\(n_{i}\)</span> unit.</p>
</div>
</section>
<section id="covariance-and-correlation" class="slide level2 smaller">
<h2>Covariance and correlation</h2>
<div style="font-size: 75%;">
<p>Two aspects of longitudinal data complicate their statistical analysis:</p>
<ol type="1">
<li>repeated measurements on the same cluster (individual) are usually <strong>positively correlated</strong></li>
<li>variability is often <strong>heterogeneous</strong> across measurements</li>
</ol>
<p>Standard linear regression models violate these assumptions!</p>
<p>For the vector of repeated measures of the <span class="math inline">\(i\)</span>th cluster, <span class="math inline">\(Y_{i}=(Y_{i1}, Y_{i2},...,Y_{in})^{T}\)</span>, we define the variance-covariance matrix, <span class="math inline">\(\text{Cov}(Y_{i})\)</span> as <span class="math display">\[
\begin{aligned}
\text{Cov}(Y_i) = \text{Cov}\left(\begin{array}{c}
Y_{i1}\\
Y_{i2}\\
\vdots \\
Y_{in}
\end{array}\right) &amp;=
\left(\begin{array}{cccc}
\text{Var}({Y_{i1}}) &amp; \text{Cov}(Y_{i1}, Y_{i2}) &amp;...&amp; \text{Cov}(Y_{i1}, Y_{in})\\
\text{Cov}(Y_{i2}, Y_{i1}) &amp; \text{Var}({Y_{i2}}) &amp;...&amp; \text{Cov}(Y_{i2}, Y_{in})\\
\vdots &amp; \vdots  &amp; \ddots  &amp; \vdots \\
\text{Cov}(Y_{in}, Y_{i1}) &amp; \text{Cov}(Y_{in}, Y_{i2}) &amp; ... &amp; \text{Var}({Y_{in}})
\end{array}\right) \\ \\
&amp;=
\left(\begin{array}{cccc}
\sigma_{1}^{2} &amp; \sigma_{12} &amp;...&amp; \sigma_{1n}\\
\sigma_{21} &amp; \sigma_{2}^{2} &amp;...&amp; \sigma_{2n}\\
\vdots &amp; \vdots  &amp; \ddots  &amp; \vdots \\
\sigma_{n1} &amp; \sigma_{n2} &amp; ... &amp; \sigma_{n}^{2}
\end{array}\right)
\end{aligned}
\]</span> where <span class="math inline">\(\text{Cov}(Y_{ij}, Y_{ik}) = \sigma_{jk} = \sigma_{kj} = \text{Cov}(Y_{ik}, Y_{ij})\)</span>.</p>
</div>
</section>
<section id="modeling-correlated-data" class="slide level2 smaller">
<h2>Modeling correlated data</h2>
<p>When analyzing correlated data, we need to model two components:</p>
<ol type="1">
<li>mean response over time</li>
<li>covariance</li>
</ol>
<p>Models for correlated data must <strong>jointly</strong> specify models for the mean and covariance.</p>
<p><a href=""><strong>Modeling the mean</strong></a> Two main approaches for modeling the mean are:</p>
<ul>
<li>analysis of response profiles</li>
<li>parametric or semi-parametric curves</li>
</ul>
<p><a href=""><strong>Modeling the covariance</strong></a> Three broad approaches for modeling the covariance are:</p>
<ul>
<li>“unstructured” or arbitrary pattern of covariance</li>
<li>covariance pattern models</li>
<li>random effects covariance structure</li>
</ul>
</section>
<section id="general-linear-model-for-longitudinal-data" class="slide level2">
<h2>General Linear Model for longitudinal data</h2>
<h4 id="linear-trend-over-time">Linear trend over time</h4>
<ul>
<li>The <strong>simplest</strong> possible curve for describing changes in the mean response over time is a <strong>straight line</strong></li>
<li>In this model the <strong>slope</strong> for time has a direct interpretation in terms of a <strong>constant change</strong> in the mean response for a single-unit change in time</li>
</ul>
</section>
<section id="mean-and-variance-functions-for-longitudinal" class="slide level2 smaller">
<h2>Mean and variance functions for longitudinal</h2>
<p>With <span class="math inline">\(i=1,...,N\)</span> individuals measured at <span class="math inline">\(j=1,...,n\)</span> occasions and <span class="math inline">\(p\)</span> predictors, we can formulate a general linear regression model as:</p>
<p><span class="math display">\[
\boldsymbol{Y}_{i}= \boldsymbol{X}_{i}\boldsymbol{\beta} + \boldsymbol{\epsilon}_{i}, \quad i = 1,...,N.
\]</span> Note: From this point forward, I will <em>stop</em> expressing vectors and matrices using bold fonts, but please remember that generally, <span class="math inline">\(Y_{i}\)</span> is a vector of responses for individual <span class="math inline">\(i\)</span>, <span class="math inline">\(X_{i}\)</span> is a matrix of predictors/covariates for individual <span class="math inline">\(i\)</span> and so on.</p>
</section>
<section id="mean-and-variance-functions-for-longitudinal-1" class="slide level2 smaller">
<h2>Mean and variance functions for longitudinal</h2>
<p>We assume that <span class="math display">\[ E(\epsilon_{i}) = 0\]</span> and <span class="math inline">\(\epsilon_{i}\)</span> has an <strong>unknown</strong> covariance structure,</p>
<p><span class="math display">\[
\Sigma_{i} =
\text{Cov}(\epsilon_{i}) =
\left(\begin{array}{cccc}
\text{var}(\epsilon_{i1}) &amp; \text{cov}(\epsilon_{i1}, \epsilon_{i2}) &amp; ... &amp;  \text{cov}(\epsilon_{i1}, \epsilon_{in})\\ \text{cov}(\epsilon_{i2}, \epsilon_{i1}) &amp; \text{var}(\epsilon_{i2}) &amp; ... &amp;  \text{cov}(\epsilon_{i2}, \epsilon_{in})\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
\text{cov}(\epsilon_{in}, \epsilon_{i1}) &amp; \text{cov}(\epsilon_{in}, \epsilon_{i2}) &amp; ... &amp; \text{var}(\epsilon_{in})
\end{array}\right)
\]</span></p>
</section>
<section id="mean-and-variance-functions-for-longitudinal-2" class="slide level2 smaller">
<h2>Mean and variance functions for longitudinal</h2>
<p>It follows that</p>
<p><span class="math display">\[
E(Y_{i}|X_{i}) = E({X}_{i}\beta + \epsilon_{i}) = E(X_{i}\beta) + E(\epsilon_{i}) = X_{i}\beta + 0 = X_{i}\beta  
\]</span> and <span class="math display">\[
\text{Cov}(Y_{i}|X_{i}) = \text{Cov}({X}_{i}\beta + \epsilon_{i}) = \text{Cov}(\epsilon_{i}) = \Sigma_{i} = \Sigma_{i}(\theta)
\]</span> where <span class="math inline">\(\theta\)</span> is a <span class="math inline">\(q \times 1\)</span> vector of parameters that “make up” the structure for the covariance matrix <span class="math inline">\(\Sigma_{i}\)</span>.</p>
<p>Therefore, the response vector <span class="math inline">\(Y_{i}\)</span> is assumed to have a conditional distribution that is multivariate normal with mean <span class="math inline">\(X_{i}\beta\)</span> and covariance matrix <span class="math inline">\(\Sigma_{i}(\theta)\)</span>:</p>
<p><span class="math display">\[
Y_{i}|X_{i} \sim MVN(X_{i}\beta, \Sigma_{i})
\]</span></p>
</section>
<section id="model-mean-for-dental-study" class="slide level2 smaller">
<h2>Model mean for dental study</h2>

<img data-src="index_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch"></section>
<section id="model-mean-for-dental-study-1" class="slide level2 smaller">
<h2>Model mean for dental study</h2>
<h4 id="a-linear-spline-model-with-a-knot-at-age-10-assuming-most-general-covariance-structure-for-now">A linear spline model with a knot at age 10 assuming most general covariance structure (for now)</h4>
<p><span class="math display">\[
\begin{aligned}
E(\text{Distance}_{ij}) &amp;= \beta_{1} + \beta_{2}\text{age}_{ij} + \beta_{3}(\text{age}_{ij}-10)_{+} + \beta_{4}\text{male}_{i} \\ &amp;+ \beta_{5}\text{age}_{ij}\times\text{male}_{i} + \beta_{6}(\text{age}_{ij}-10)_{+}\times \text{male}_{i}
\end{aligned}
\]</span> where <span class="math inline">\((x)_{+}\)</span> is the <em>truncated line function</em> defined as</p>
<p><span class="math display">\[
(x)_{+} =
\begin{cases}
x \quad \text{ if } x &gt; 0 \\
0 \quad \text{ otherwise}.
\end{cases}
\]</span></p>
<p>Therefore,</p>
<p><span class="math display">\[
(\text{age}_{ij} - 10)_{+} =
\begin{cases}
\begin{aligned}
&amp;\text{age}_{ij} - 10 &amp;\text{when } \text{age}_{ij} &gt; 10 \\
&amp;0 &amp;\text{when } \text{age}_{ij} \le 10.
\end{aligned}
\end{cases}
\]</span></p>
</section>
<section id="expected-means" class="slide level2 smaller">
<h2>Expected means</h2>
<p>Expected mean response for females prior to and after age <span class="math inline">\(10\)</span>,</p>
<p><span class="math display">\[
\begin{aligned}
E(\text{Distance}_{ij}) &amp;= \beta_{1} + \beta_{2}\text{age}_{ij}
&amp; \text{age}_{ij} \le 10;\\\\
E(\text{Distance}_{ij}) &amp;= (\beta_{1}-10\beta_{3}) + (\beta_{2}+\beta_{3})\text{age}_{ij}
&amp; \text{age}_{ij} &gt; 10.
\end{aligned}
\]</span></p>
<p>Expected mean response for males prior to and after age <span class="math inline">\(10\)</span>,</p>
<p><span class="math display">\[
\begin{aligned}
E(\text{Distance}_{ij}) &amp;= (\beta_{1}+ \beta_{4}) + (\beta_{2} + \beta_{5})\text{age}_{ij}
&amp; \text{age}_{ij} \le 10;\\\\
E(\text{Distance}_{ij}) &amp;= (\beta_{1}+ \beta_{4}) - 10(\beta_{3}+\beta_{6}) + (\beta_{2} + \beta_{3} + \beta_{5} + \beta_{6})\text{age}_{ij}  
&amp; \text{age}_{ij} &gt; 10.
\end{aligned}
\]</span></p>
</section>
<section id="model-mean-for-dental-study-2" class="slide level2 smaller">
<h2>Model mean for dental study</h2>
<div class="cell columns column-output-location">
<div class="column">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>knot <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># let t* = age 10</span></span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a>dentallong <span class="ot">&lt;-</span> dental <span class="sc">%&gt;%</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"distance"</span>),</span>
<span id="cb11-5"><a href="#cb11-5"></a>               <span class="at">names_to =</span> <span class="st">"age"</span>,</span>
<span id="cb11-6"><a href="#cb11-6"></a>               <span class="co"># this removes "distance_age" from the values</span></span>
<span id="cb11-7"><a href="#cb11-7"></a>               <span class="at">names_prefix =</span> <span class="st">"distance_age"</span>, </span>
<span id="cb11-8"><a href="#cb11-8"></a>               <span class="at">values_to =</span> <span class="st">"distance"</span>,</span>
<span id="cb11-9"><a href="#cb11-9"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb11-10"><a href="#cb11-10"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb11-11"><a href="#cb11-11"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">row_number</span>(),</span>
<span id="cb11-12"><a href="#cb11-12"></a>         <span class="co"># for this model, we want age as continuous</span></span>
<span id="cb11-13"><a href="#cb11-13"></a>         <span class="at">age =</span> <span class="fu">as.numeric</span>(age), </span>
<span id="cb11-14"><a href="#cb11-14"></a>         <span class="co"># make a 1/0 binary variable group</span></span>
<span id="cb11-15"><a href="#cb11-15"></a>         <span class="at">group =</span> <span class="fu">case_when</span>(     </span>
<span id="cb11-16"><a href="#cb11-16"></a>           gender <span class="sc">==</span> <span class="st">"F"</span> <span class="sc">~</span> <span class="dv">0</span>,</span>
<span id="cb11-17"><a href="#cb11-17"></a>           gender <span class="sc">==</span> <span class="st">"M"</span> <span class="sc">~</span> <span class="dv">1</span></span>
<span id="cb11-18"><a href="#cb11-18"></a>         ),</span>
<span id="cb11-19"><a href="#cb11-19"></a>         <span class="co"># code to apply truncated linear function</span></span>
<span id="cb11-20"><a href="#cb11-20"></a>         <span class="at">ageknot =</span> (age <span class="sc">-</span> knot) <span class="sc">*</span> <span class="fu">I</span>(age <span class="sc">&gt;=</span> knot)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-21"><a href="#cb11-21"></a>  <span class="co"># same can be achieved by </span></span>
<span id="cb11-22"><a href="#cb11-22"></a>  <span class="co"># ageknot = ifelse(age &gt;= knot, age - knot, 0)</span></span>
<span id="cb11-23"><a href="#cb11-23"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb11-24"><a href="#cb11-24"></a></span>
<span id="cb11-25"><a href="#cb11-25"></a>dentallong[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div><div class="column">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 7
      id gender   age distance  time group  ageknot
   &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;int&gt; &lt;dbl&gt; &lt;I&lt;dbl&gt;&gt;
 1     1 F          8     21       1     0        0
 2     1 F         10     20       2     0        0
 3     1 F         12     21.5     3     0        2
 4     1 F         14     23       4     0        4
 5     2 F          8     21       1     0        0
 6     2 F         10     21.5     2     0        0
 7     2 F         12     24       3     0        2
 8     2 F         14     25.5     4     0        4
 9     3 F          8     20.5     1     0        0
10     3 F         10     24       2     0        0
11     3 F         12     24.5     3     0        2
12     3 F         14     26       4     0        4
13     4 F          8     23.5     1     0        0
14     4 F         10     24.5     2     0        0
15     4 F         12     25       3     0        2
16     4 F         14     26.5     4     0        4
17     5 F          8     21.5     1     0        0
18     5 F         10     23       2     0        0
19     5 F         12     22.5     3     0        2
20     5 F         14     23.5     4     0        4</code></pre>
</div>
</div>
</div>
</section>
<section id="use-gls-from-nlme-package" class="slide level2 smaller">
<h2>Use <code>gls()</code> from <code>nlme</code> package</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>dentalpw <span class="ot">&lt;-</span> <span class="fu">gls</span>(distance <span class="sc">~</span> group <span class="sc">+</span> age <span class="sc">+</span> ageknot <span class="sc">+</span> group <span class="sc">*</span> age <span class="sc">+</span> group <span class="sc">*</span> ageknot, </span>
<span id="cb13-2"><a href="#cb13-2"></a>                <span class="co"># short hand form: distance ~ group * age + group * ageknot</span></span>
<span id="cb13-3"><a href="#cb13-3"></a>                <span class="at">corr=</span><span class="fu">corSymm</span>(<span class="at">form=</span> <span class="sc">~</span> time <span class="sc">|</span> id), <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> time), </span>
<span id="cb13-4"><a href="#cb13-4"></a>                <span class="at">data =</span> dentallong)</span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="fu">summary</span>(dentalpw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized least squares fit by REML
  Model: distance ~ group + age + ageknot + group * age + group * ageknot 
  Data: dentallong 
       AIC      BIC    logLik
  455.2452 497.2447 -211.6226

Correlation Structure: General
 Formula: ~time | id 
 Parameter estimate(s):
 Correlation: 
  1     2     3    
2 0.578            
3 0.660 0.583      
4 0.523 0.727 0.739
Variance function:
 Structure: Different standard deviations per stratum
 Formula: ~1 | time 
 Parameter estimates:
        1         2         3         4 
1.0000000 0.8800358 1.0791408 0.9622584 

Coefficients:
                  Value Std.Error   t-value p-value
(Intercept)   17.188902  2.485646  6.915266  0.0000
group          1.719649  3.228949  0.532572  0.5955
age            0.502160  0.258826  1.940144  0.0551
ageknot       -0.032163  0.298101 -0.107894  0.9143
group:age     -0.009843  0.336225 -0.029276  0.9767
group:ageknot  0.449226  0.387244  1.160058  0.2487

 Correlation: 
              (Intr) group  age    ageknt grop:g
group         -0.770                            
age           -0.973  0.749                     
ageknot        0.882 -0.679 -0.924              
group:age      0.749 -0.973 -0.770  0.711       
group:ageknot -0.679  0.882  0.711 -0.770 -0.924

Standardized residuals:
        Min          Q1         Med          Q3         Max 
-2.51980558 -0.65360368 -0.07447669  0.58689210  2.13631270 

Residual standard error: 2.32045 
Degrees of freedom: 108 total; 102 residual</code></pre>
</div>
</div>
<p><code>gls()</code> function uses Restricted maximum likelihood estimation (REML) by default</p>
</section>
<section id="compare-observed-and-expected-means" class="slide level2">
<h2>Compare observed and expected means</h2>

<img data-src="index_files/figure-revealjs/unnamed-chunk-11-1.png" width="960" class="r-stretch"></section>
<section id="compare-different-mean-models" class="slide level2 smaller">
<h2>Compare different mean models</h2>
<p>A simpler model</p>
<p><span class="math display">\[
\begin{aligned}
E(\text{Distance}_{ij}) = \beta_{1} + \beta_{2}\text{age}_{ij} + \beta_{3}\text{male}_{i} + \beta_{4}\text{age}_{ij}\times\text{male}_{i}
\end{aligned}
\]</span> When comparing different mean models with the same covariance, use ML estimation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>dentpwML <span class="ot">&lt;-</span> <span class="fu">gls</span>(distance <span class="sc">~</span> group <span class="sc">*</span> age <span class="sc">+</span> group <span class="sc">*</span> ageknot, </span>
<span id="cb15-2"><a href="#cb15-2"></a>                <span class="at">corr=</span><span class="fu">corSymm</span>(<span class="at">form=</span> <span class="sc">~</span> time <span class="sc">|</span> id), <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> time),</span>
<span id="cb15-3"><a href="#cb15-3"></a>                <span class="at">method =</span> <span class="st">"ML"</span>, <span class="at">data =</span> dentallong)</span>
<span id="cb15-4"><a href="#cb15-4"></a>dentlinML <span class="ot">&lt;-</span> <span class="fu">gls</span>(distance <span class="sc">~</span> group <span class="sc">*</span> age, </span>
<span id="cb15-5"><a href="#cb15-5"></a>                 <span class="at">corr=</span><span class="fu">corSymm</span>(<span class="at">form =</span> <span class="sc">~</span> time <span class="sc">|</span> id), <span class="at">weights =</span> <span class="fu">varIdent</span>(<span class="at">form =</span> <span class="sc">~</span> <span class="dv">1</span> <span class="sc">|</span> time),</span>
<span id="cb15-6"><a href="#cb15-6"></a>                 <span class="at">method =</span> <span class="st">"ML"</span>, <span class="at">data =</span> dentallong)</span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="fu">anova</span>(dentpwML, dentlinML)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Model df      AIC      BIC    logLik   Test  L.Ratio p-value
dentpwML      1 16 448.5572 491.4713 -208.2786                        
dentlinML     2 14 447.4770 485.0269 -209.7385 1 vs 2 2.919806  0.2323</code></pre>
</div>
</div>
</section>
<section id="modelling-the-covariance" class="slide level2 smaller">
<h2>Modelling the covariance</h2>
<ul>
<li>So far, our focus has been on <strong>modeling the mean response</strong> and we have been assuming the <strong>unstructured</strong> covariance matrix in our analyses of longitudinal data
<ul>
<li>This is the most <strong>general</strong> type of covariance matrix that allows any arbitrary pattern of covariance among the repeated measures</li>
</ul></li>
<li>Alternatively, we can impose more <strong>structure</strong> when modeling the covariance</li>
</ul>
<p><a href=""><strong>Modeling the covariance</strong></a> Three broad approaches for modeling the covariance are:</p>
<ul>
<li>“unstructured” or arbitrary pattern of covariance</li>
<li>covariance pattern models</li>
<li>random effects covariance structure</li>
</ul>
</section>
<section id="modelling-the-covariance-1" class="slide level2 smaller">
<h2>Modelling the covariance</h2>
<ul>
<li>When an appropriate model for the covariance has been adopted, <strong>correct standard errors</strong> are obtained and <strong>valid inferences</strong> about the regression parameters can be made</li>
<li>Accounting for the covariance among repeated measures usually <strong>increases efficiency</strong> or the <strong>precision</strong> with which the regression parameters can be estimated
<ul>
<li>The positive correlation among the repeated measures <strong>reduces the variability</strong> of the estimate of change over time within individuals</li>
</ul></li>
<li>The choice of models for the mean response and the covariance are <strong>interdependent</strong>
<ul>
<li>The covariance between any pair of <strong>residuals</strong>, say <span class="math inline">\(Y_{ij} - \mu_{ij}(\beta)\)</span> and <span class="math inline">\(Y_{ik} - \mu_{ik}(\beta)\)</span>, depends on the model for the mean (i.e.&nbsp;depends on <span class="math inline">\(\beta\)</span>)</li>
</ul></li>
<li>Although the covariance among the repeated responses, is not usually of intrinsic interest, it cannot simply be ignored</li>
</ul>
</section>
<section id="unstructured-covariance" class="slide level2 smaller">
<h2>Unstructured covariance</h2>
<ul>
<li>The unstructured covariance matrix assumes no explicit structure among the repeated responses, other than the homogeneity of covariance across different individuals
<ul>
<li><span class="math inline">\(\Sigma_{i}(\theta) = \Sigma(\theta) \text{ for all } i\)</span></li>
</ul></li>
<li>Appropriate when the number of measurement occasions is <strong>relatively small</strong> and all individuals are measured at the <strong>same set of occasions</strong> (data is balanced)</li>
</ul>
<p><span class="math display">\[
\text{Cov}(Y_{i}) =
\left(\begin{array}{cccc}
\sigma_{1}^{2} &amp; \sigma_{12} &amp;...&amp; \sigma_{1n}\\
\sigma_{21} &amp; \sigma_{2}^{2} &amp;...&amp; \sigma_{2n}\\
\vdots &amp; \vdots  &amp; \ddots  &amp; \vdots \\
\sigma_{n1} &amp; \sigma_{n2} &amp; ... &amp; \sigma_{n}^{2}
\end{array}\right)
\]</span></p>
<ul>
<li>When <span class="math inline">\(n\)</span> measurement occasions, the unstructured covariance matrix has <span class="math inline">\(n\)</span> variance and <span class="math inline">\(\frac{n\times (n+1)}{2}\)</span> covariance parameters
<ul>
<li><span class="math inline">\(\theta = (\sigma^{2}_{1},...,\sigma_{n}^{2}, \sigma_{12},...,\sigma_{n(n-1)})\)</span> is a vector of length <span class="math inline">\(\frac{n\times (n+1)}{2}\)</span></li>
</ul></li>
</ul>
</section>
<section id="unstructured-covariance-1" class="slide level2 smaller">
<h2>Unstructured covariance</h2>
<p><a href=""><strong>Main advantage</strong></a> No assumptions are made about the patterns of variances and covariances</p>
<p><a href=""><strong>Potential drawbacks</strong></a></p>
<ul>
<li>The number of variance parameters grows rapidly with the number of measurement occasions</li>
</ul>

<img data-src="index_files/figure-revealjs/unnamed-chunk-13-1.png" width="960" class="r-stretch"><ul>
<li>When number of covariance parameters (length of <span class="math inline">\(\theta\)</span>) is large, relative to sample size (<span class="math inline">\(N\)</span>), estimation is likely to be <strong>very unstable</strong></li>
<li>Problematic when there are <strong>mistimed</strong> measurements</li>
</ul>
</section>
<section id="covariance-pattern-models" class="slide level2 smaller">
<h2>Covariance pattern models</h2>
<ul>
<li>When sample size is <strong>not sufficiently large</strong> to estimate an unstructured covariance, we want to impose some <strong>structure</strong> on the covariance matrix</li>
<li>A subtle <strong>balance</strong> needs to be struck when attempting to impose some structure on the covariance matrix
<ul>
<li>With too little structure, there may be <strong>too many parameters</strong> to be estimated with limited amount of data</li>
<li>With too much structure, there is a potential risk of model <strong>misspecification</strong></li>
<li>Both could result in <strong>misleading inferences</strong> concerning <span class="math inline">\(\beta\)</span></li>
</ul></li>
<li>Classic tradeoff between <strong>bias and variance</strong></li>
<li>Covariance pattern models have their basis in models for <strong>serial correlation</strong> originally developed for <strong>time series</strong> data</li>
</ul>
</section>
<section id="compound-symmetry-exchangeable" class="slide level2 smaller">
<h2>Compound symmetry (Exchangeable)</h2>
<p>The compound symmetry structure assumes that variance is constant across occasions, say <span class="math inline">\(\sigma^{2}\)</span>, and <span class="math inline">\(\text{Corr}(Y_{ij}, Y_{ik}) = \rho\)</span> for all <span class="math inline">\(j\)</span> and <span class="math inline">\(k\)</span>.</p>
<p><span class="math display">\[
\text{Cov}(Y_{i}) =
\sigma^{2}
\left(\begin{array}{ccccc}
1 &amp; \rho &amp; \rho &amp; ...&amp; \rho\\
\rho &amp; 1 &amp; \rho &amp; ... &amp; \rho\\
\rho &amp; \rho &amp; 1 &amp; ... &amp; \rho\\
\vdots &amp; \vdots &amp; \vdots  &amp; \ddots  &amp; \vdots \\
\rho &amp; \rho &amp; \rho &amp; ... &amp; 1\\
\end{array}\right)
\]</span></p>
<ul>
<li><strong>Very parsimonious</strong>: only <strong>two</strong> parameters regardless of number of measurements occasions</li>
<li>Makes strong assumptions about the variance and correlation which is unappealing for longitudinal data
<ul>
<li>But more appropriate for <strong>clustered</strong> data with no inherent order of units within the cluster <span class="math inline">\(\rightarrow\)</span> More on this later in the course!</li>
</ul></li>
</ul>
</section>
<section id="toeplitz" class="slide level2 smaller">
<h2>Toeplitz</h2>
<p>The Toeplitz structure assumes that variance is constant across occasions (<span class="math inline">\(\sigma^{2}\)</span>), and <span class="math inline">\(\text{Corr}(Y_{ij}, Y_{i,j+k}) = \rho_{k}\)</span> for all <span class="math inline">\(j\)</span> and <span class="math inline">\(k\)</span>.</p>
<p><span class="math display">\[
\text{Cov}(Y_{i}) =
\sigma^{2}
\left(\begin{array}{ccccc}
1 &amp; \rho_{1} &amp; \rho_{2} &amp; ...&amp; \rho_{n-1}\\
\rho_{1} &amp; 1 &amp; \rho_{1} &amp; ... &amp; \rho_{n-2}\\
\rho_{2} &amp; \rho_{1} &amp; 1 &amp; ... &amp; \rho_{n-3}\\
\vdots &amp; \vdots &amp; \vdots  &amp; \ddots  &amp; \vdots \\
\rho_{n-1} &amp; \rho_{n-2} &amp; \rho_{n-3} &amp; ... &amp; 1\\
\end{array}\right)
\]</span></p>
<ul>
<li>Assumes correlation among responses at <strong>adjacent</strong> measurement occasions is constant, <span class="math inline">\(\rho_{1}\)</span></li>
<li>Only appropriate when measurements are made at <strong>equal</strong> (or approximately equal) intervals of time</li>
</ul>
</section>
<section id="first-order-autoregressive-ar1" class="slide level2 smaller">
<h2>First-order autoregressive (AR1)</h2>
<p>The AR1 structure assumes that variance is constant across occasions (<span class="math inline">\(\sigma^{2}\)</span>), and <span class="math inline">\(\text{Corr}(Y_{ij}, Y_{i,j+k}) = \rho^{k}\)</span> for all <span class="math inline">\(j\)</span> and <span class="math inline">\(k\)</span>.</p>
<p><span class="math display">\[
\text{Cov}(Y_{i}) =
\sigma^{2}
\left(\begin{array}{ccccc}
1 &amp; \rho &amp; \rho^{2} &amp; ...&amp; \rho^{n-1}\\
\rho &amp; 1 &amp; \rho &amp; ... &amp; \rho^{n-2}\\
\rho^{2} &amp; \rho &amp; 1 &amp; ... &amp; \rho^{n-3}\\
\vdots &amp; \vdots &amp; \vdots  &amp; \ddots  &amp; \vdots \\
\rho^{n-1} &amp; \rho^{n-2} &amp; \rho^{n-3} &amp; ... &amp; 1\\
\end{array}\right)
\]</span></p>
<ul>
<li><strong>Very parsimonious</strong>: only <strong>two</strong> parameters regardless of number of measurements occasions</li>
<li>Only appropriate when measurements are made at <strong>equal</strong> (or approximately equal) intervals of time</li>
</ul>
</section>
<section id="heterogeneous-variances" class="slide level2 smaller">
<h2>Heterogeneous variances</h2>
<ul>
<li>The compound symmetry, Toeplitz, and AR1 covariances assume that the variances are constant across time</li>
<li>This assumption can easily be relaxed by assuming a covariance structure model with <strong>heterogeneous</strong> variances, <span class="math inline">\(\text{Var}(Y_{ij})=\sigma_{j}^{2}\)</span>.
<ul>
<li>We have been doing this in prior analyses.</li>
</ul></li>
</ul>
<p>A heterogeneous AR1 covariance pattern model is given by</p>
<p><span class="math display">\[
\text{Cov}(Y_{i}) =
\left(\begin{array}{ccccc}
\sigma_{1}^{2} &amp; \rho\sigma_{1}\sigma_{2} &amp; \rho^{2}\sigma_{1}\sigma_{3} &amp; ...&amp; \rho^{n-1}\sigma_{1}\sigma_{n}\\
\rho\sigma_{1}\sigma_{2} &amp; \sigma_{2}^{2} &amp; \rho\sigma_{2}\sigma_{3} &amp; ... &amp; \rho^{n-2}\sigma_{2}\sigma_{n}\\
\rho^{2}\sigma_{1}\sigma_{3} &amp; \rho\sigma_{2}\sigma_{3} &amp; \sigma_{3}^{2} &amp; ... &amp; \rho^{n-3}\sigma_{3}\sigma_{n}\\
\vdots &amp; \vdots &amp; \vdots  &amp; \ddots  &amp; \vdots \\
\rho^{n-1}\sigma_{1}\sigma_{n} &amp; \rho^{n-2}\sigma_{2}\sigma_{n} &amp; \rho^{n-3}\sigma_{3}\sigma_{n} &amp; ... &amp; \sigma_{n}^{2}\\
\end{array}\right)
\]</span></p>
<p>and has <span class="math inline">\(n+1\)</span> parameters (<span class="math inline">\(n\)</span> variance parameters and 1 correlation parameter).</p>
</section>
<section id="exponential" class="slide level2 smaller">
<h2>Exponential</h2>
<p>When measurement occasions are <strong>not</strong> equally-spaced over time, autoregressive model can be <strong>generalized</strong> as follows.</p>
<p>Let <span class="math inline">\(\left\{t_{i1},...,t_{in}\right\}\)</span> denote the observation times for the <span class="math inline">\(i\)</span>th individual and assume that the variance is constant across all measurement occasions (<span class="math inline">\(\sigma^{2}\)</span>), and <span class="math display">\[
\small
\text{Corr}(Y_{ij}, Y_{ik})=\rho^{|t_{ij} - t_{ik}|},
\]</span> for <span class="math inline">\(\rho \ge 0\)</span>.</p>
<ul>
<li>Correlation between any pair of repeated measures decreases exponentially with the time separations between them</li>
<li>Exponential covariance model is <strong>invariant</strong> under linear transformation of the time scale
<ul>
<li>If we replace time measured in “weeks” by time measured in “days”, the same form of the covariance matrix holds</li>
</ul></li>
</ul>
</section>
<section id="options-in-gls" class="slide level2 smaller">
<h2>Options in <code>gls()</code></h2>
<p>will give you a list of available types of correlation structures in the <code>nlme</code> package.</p>
<table>
<thead>
<tr class="header">
<th>Structure</th>
<th>R option</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Unstructured</td>
<td><code>corSymm(form = ~ t*|id)</code></td>
</tr>
<tr class="even">
<td>Compound symmetry</td>
<td><code>corCompSymm(form = ~ t*|id)</code></td>
</tr>
<tr class="odd">
<td>Toeplitz</td>
<td><code>corARMA(form = ~ t*|id, p=1, q=1)</code></td>
</tr>
<tr class="even">
<td>AR1</td>
<td><code>corAR1(form = ~ t*|id)</code></td>
</tr>
<tr class="odd">
<td>Exponential</td>
<td><code>corExp(form = ~ t|id)</code></td>
</tr>
</tbody>
</table>
<p>Note: <code>t*</code> is the measurement occasion and <code>t</code> is the actual time unit.</p>
</section>
<section id="choice-among-covariance-pattern-models" class="slide level2 smaller">
<h2>Choice among covariance pattern models</h2>
<p>The choice among the covariance pattern models can be made by comparing the <strong>maximized likelihoods</strong>.</p>
<h4 id="likelihood-ratio-test-lrt">Likelihood ratio test (LRT)</h4>
<ul>
<li>When any pair of models is <strong>nested</strong>, a LRT statistic from <strong>REML</strong> log-likelihoods can be constructed that compares the <em>full</em> and <em>reduced</em> models
<ul>
<li>For example: AR1 and compound symmetry are both nested within unstructured</li>
<li>Another example: AR1 is nested within heterogeneous AR1</li>
</ul></li>
</ul>
</section>
<section id="choice-among-covariance-pattern-models-1" class="slide level2 smaller">
<h2>Choice among covariance pattern models</h2>
<h4 id="akaike-information-criterion-aic">Akaike information criterion (AIC)</h4>
<ul>
<li>Often we want to compare non-nested models for the covariance
<ul>
<li>For example: AR1 vs compound symmetry</li>
</ul></li>
<li>Select the model that <strong>minimizes</strong> <span class="math display">\[
AIC = -2(\hat{l}-c),
\]</span> where <span class="math inline">\(\hat{l}\)</span> is the maximized <strong>REML</strong> log-likelihood and <span class="math inline">\(c\)</span> is the number of covariance parameters (length of <span class="math inline">\(\theta \text{ for } \Sigma_{i}(\theta)\)</span>)</li>
</ul>
<h4 id="bayesian-information-criterion-bic">Bayesian information criterion (BIC)</h4>
<ul>
<li>Another criterion for <strong>non-nested</strong> models</li>
<li>Select the model that <strong>minimizes</strong> <span class="math display">\[
BIC = -2(\hat{l}-\text{log} \sqrt{N^{*}}c),
\]</span> where <span class="math inline">\(N^{*} = N-p\)</span> is the number of <em>effective</em> subjects for <strong>REML</strong> log-likelihood</li>
</ul>
<div class="footer footer-default">

</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="index_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="index_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="index_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="index_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="index_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="index_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="index_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="index_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>